jQuery(function(){});var islogin=!1;
function initMsg(){jQuery.post("/codegen/getUser","",function(a){if("000000"==a.code)jQuery("#loginName").html(a.data.nickname+"&nbsp;&nbsp;<a href='/user/logout'>\u9000\u51fa</a>"),islogin=!0;else return jQuery(document).scrollTop(),jQuery.jGrowl("\u53cb\u60c5\u63d0\u793a:\u751f\u6210\u529f\u80fd\u9700\u8981\u767b\u5f55\u540e\u65b9\u53ef\u4f7f\u7528!",{life:1E4,position:"center"}),!1});jQuery.post("/user/sumuse","",function(a){"000000"==a.code&&(jQuery("#rate").text(a.data.rate),jQuery("#sumuse").text(a.data.sumuse))})}
function notopen(){jAlert("\u529f\u80fd\u6b63\u5728\u5efa\u8bbe\uff0c\u656c\u8bf7\u671f\u5f85","\u53cb\u60c5\u63d0\u793a")}
function getDBTable(){if(islogin){var a=jQuery("#dbType").val(),b=jQuery("#jdbcUrl").val(),c=jQuery("#username").val(),d=jQuery("#password").val();if(null==a||""==a)return jAlert("\u8bf7\u9009\u62e9\u6570\u636e\u5e93\u7c7b\u578b","\u53cb\u60c5\u63d0\u793a"),!1;if(null==b||""==b)return jAlert("\u8bf7\u8f93\u5165\u6570\u636e\u5e93\u5730\u5740","\u53cb\u60c5\u63d0\u793a"),!1;if(null==c||""==c)return jAlert("\u8bf7\u8f93\u5165\u6570\u636e\u5e93\u5e10\u53f7","\u53cb\u60c5\u63d0\u793a"),!1;if(null==d||
    ""==d)return jAlert("\u8bf7\u8f93\u5165\u6570\u636e\u5e93\u5bc6\u7801","\u53cb\u60c5\u63d0\u793a"),!1;b=encodeURI(b,"UTF-8");c=encodeURI(c,"UTF-8");d=encodeURI(d,"UTF-8");jQuery.post("/codegen/getDBTables","dbType="+a+"&jdbcUrl="+b+"&username="+c+"&password="+d,function(a){if("000000"==a.code){jQuery("#tables").html("");var c=jQuery("#table_bf");c.html("");jQuery.each(a.data.tables,function(a,b){c.append("<option value='"+b+"'>"+b+"</option>")})}else return jAlert(a.msg,"\u53cb\u60c5\u63d0\u793a"),
    !1})}else jAlert("\u767b\u5f55\u540e\u65b9\u53ef\u4f7f\u7528\u8be5\u529f\u80fd!","\u53cb\u60c5\u63d0\u793a")}
function submitMyForm(){islogin?jQuery("#sohoform").validate({submitHandler:function(){doSubmit()},rules:{jdbcUrl:"required",username:"required",password:"required",packageName:"required",dbType:"required",moduleName:"required"},messages:{jdbcUrl:"\u8bf7\u8f93\u5165\u6570\u636e\u5e93\u5730\u5740",username:"\u8bf7\u8f93\u5165\u6570\u636e\u5e93\u5e10\u53f7",password:"\u8bf7\u8f93\u5165\u6570\u636e\u5e93\u5bc6\u7801",packageName:"\u8bf7\u8f93\u5165\u7c7b\u5305\u8def\u5f84",dbType:"\u8bf7\u9009\u62e9\u6570\u636e\u5e93\u7c7b\u578b",
        moduleName:"\u81f3\u5c11\u9009\u62e9\u4e00\u4e2a\u6a21\u5757"}}):jAlert("\u767b\u5f55\u540e\u65b9\u53ef\u4f7f\u7528\u8be5\u529f\u80fd!","\u53cb\u60c5\u63d0\u793a")}var isSubmit=!1;
function doSubmit(){if(!isSubmit){isSubmit=!0;jQuery("#submitbtn").text("\u6b63\u5728\u751f\u6210\u6587\u4ef6...").attr("disabled",!0);var a="";jQuery("input[name='moduleName']:checked").each(function(){a+=","+jQuery(this).val()});var b=jQuery("#packageName").val(),c=jQuery("#dbType").val(),d=jQuery("#jdbcUrl").val(),e=jQuery("#username").val(),f=jQuery("#password").val(),g="";jQuery("#tables option").each(function(){g+=","+jQuery(this).val()});if(""==a)return jAlert("\u81f3\u5c11\u9009\u62e9\u4e00\u4e2a\u6a21\u5757",
    "\u53cb\u60c5\u63d0\u793a"),isSubmit=!1,jQuery("#submitbtn").text("\u5f00\u59cb\u751f\u6210\u6587\u4ef6").removeAttr("disabled"),!1;a=a.substring(1);if(""==b)return jAlert("\u8bf7\u8f93\u5165\u7c7b\u5305\u8def\u5f84","\u53cb\u60c5\u63d0\u793a"),isSubmit=!1,jQuery("#submitbtn").text("\u5f00\u59cb\u751f\u6210\u6587\u4ef6").removeAttr("disabled"),!1;if(null==c||""==c)return jAlert("\u8bf7\u9009\u62e9\u6570\u636e\u5e93\u7c7b\u578b","\u53cb\u60c5\u63d0\u793a"),isSubmit=!1,jQuery("#submitbtn").text("\u5f00\u59cb\u751f\u6210\u6587\u4ef6").removeAttr("disabled"),
    !1;if(null==d||""==d)return jAlert("\u8bf7\u8f93\u5165\u6570\u636e\u5e93\u5730\u5740","\u53cb\u60c5\u63d0\u793a"),isSubmit=!1,jQuery("#submitbtn").text("\u5f00\u59cb\u751f\u6210\u6587\u4ef6").removeAttr("disabled"),!1;if(null==e||""==e)return jAlert("\u8bf7\u8f93\u5165\u6570\u636e\u5e93\u5e10\u53f7","\u53cb\u60c5\u63d0\u793a"),isSubmit=!1,jQuery("#submitbtn").text("\u5f00\u59cb\u751f\u6210\u6587\u4ef6").removeAttr("disabled"),!1;if(null==f||""==f)return jAlert("\u8bf7\u8f93\u5165\u6570\u636e\u5e93\u5bc6\u7801",
    "\u53cb\u60c5\u63d0\u793a"),isSubmit=!1,jQuery("#submitbtn").text("\u5f00\u59cb\u751f\u6210\u6587\u4ef6").removeAttr("disabled"),!1;if(""==g)return jAlert("\u81f3\u5c11\u9009\u62e9\u4e00\u4e2a\u6570\u636e\u8868","\u53cb\u60c5\u63d0\u793a"),isSubmit=!1,jQuery("#submitbtn").text("\u5f00\u59cb\u751f\u6210\u6587\u4ef6").removeAttr("disabled"),!1;g=g.substring(1);d=encodeURI(d,"UTF-8");e=encodeURI(e,"UTF-8");f=encodeURI(f,"UTF-8");jQuery.post("/codegen/generate","dbType="+c+"&jdbcUrl="+d+"&username="+
    e+"&password="+f+"&moduleName="+a+"&packageName="+b+"&tables="+g,function(a){"000000"==a.code?jConfirm("\u5df2\u6210\u529f\u751f\u6210\u6587\u4ef6,\u662f\u5426\u67e5\u770b\u6587\u4ef6\u5217\u8868?","\u53cb\u60c5\u63d0\u793a",function(a){1==a&&(getFiles(),jQuery("#basicform_li").attr("class",""),jQuery("#basicform").hide(),jQuery("#fileform_li").attr("class","current"),jQuery("#fileform").show());isSubmit=!1;jQuery("#submitbtn").text("\u5f00\u59cb\u751f\u6210\u6587\u4ef6").removeAttr("disabled")}):
    (jAlert(a.msg,"\u53cb\u60c5\u63d0\u793a"),isSubmit=!1,jQuery("#submitbtn").text("\u5f00\u59cb\u751f\u6210\u6587\u4ef6").removeAttr("disabled"))})}}
function getFiles(){jQuery("#tribune").hide();jQuery("#basicform").hide();jQuery.post("/codegen/getZipFile","",function(a){if("000000"==a.code){var b=jQuery("#fileTableBody");b.html("");var c="";"{}"==JSON.stringify(a.data)?b.html('<tr><td colspan="7" align="center" class="center">\u6682\u65e0\u6570\u636e</td></tr>'):(jQuery.each(a.data.list,function(a,b){c+="<tr id='tr_"+b.id+"'>";c+='<td align="center"><div class="checker" id="uniform-undefined"><span id=\'cbx_'+b.id+'_s1\'><div class="checker" id="uniform-undefined"><span id=\'cbx_'+
    b.id+"_s2'><input id='cbx_"+b.id+"' name='fileId' value='"+b.id+'\' style="opacity: 0;" type="checkbox" onclick="cbx_func(\'cbx_'+b.id+"')\"></span></div></span></div></td>";c+='<td width="18%">'+b.dburl+"</td>";a=b.tables;100<a.length&&(a=a.substring(0,100)+"...");c+="<td title='"+b.tables+"'>"+a+"</td>";c+='<td width="8%">'+b.fileName+"</td>";c+='<td width="8%">'+b.fileSize+"</td>";c+='<td width="8%">'+b.ctime+"</td>";c+='<td class="center" width="12%"><a class="btn btn_archive" href="/codegen/downFile?fileId='+
    b.id+'"><span>\u4e0b\u8f7d</span></a>&nbsp;<a class="btn btn_trash" onclick="delFile(\''+b.id+'\');" href="javascript:void(0);"><span>\u5220\u9664</span></a>&nbsp;</td>';c+="</tr>"}),b.html(c))}})}
function delFile(a){islogin?jConfirm("\u5220\u9664\u6587\u4ef6\u540e\u65e0\u6cd5\u6062\u590d,\u786e\u5b9a\u5220\u9664?","\u53cb\u60c5\u63d0\u793a",function(b){1==b&&jQuery.post("/codegen/delFile","cbx_ids="+a,function(a){"000000"==a.code?(getFiles(),jAlert(a.data.result,"\u53cb\u60c5\u63d0\u793a")):jAlert(a.msg,"\u53cb\u60c5\u63d0\u793a")})}):jAlert("\u60a8\u5c1a\u672a\u767b\u5f55!","\u53cb\u60c5\u63d0\u793a")}
function delAllFile(){if(islogin){var a="",b=0;jQuery.each(jQuery("input:checkbox[name='fileId']:checked"),function(c,d){jQuery(this).is(":checked")&&(a+=","+jQuery(this).val(),b++)});if(""==a)return jAlert("\u8bf7\u9009\u62e9\u5220\u9664\u7684\u8bb0\u5f55","\u53cb\u60c5\u63d0\u793a"),!1;jConfirm("\u9009\u4e2d["+b+"]\u6761\u8bb0\u5f55,\u5220\u9664\u6587\u4ef6\u540e\u65e0\u6cd5\u6062\u590d,\u786e\u5b9a\u5220\u9664?","\u53cb\u60c5\u63d0\u793a",function(b){1==b&&jQuery.post("/codegen/delFile","cbx_ids="+
    a.substring(1),function(a){"000000"==a.code?(getFiles(),jAlert(a.data.result,"\u53cb\u60c5\u63d0\u793a")):jAlert(a.msg,"\u53cb\u60c5\u63d0\u793a")})})}else jAlert("\u60a8\u5c1a\u672a\u767b\u5f55!","\u53cb\u60c5\u63d0\u793a")}function cbx_func(a){jQuery("#"+a).is(":checked")?(jQuery("#"+a+"_s1").attr("class","checked"),jQuery("#"+a+"_s2").attr("class","checked")):(jQuery("#"+a+"_s1").attr("class",""),jQuery("#"+a+"_s2").attr("class",""))}
function cbx_selAll(){jQuery("#cbx_all").is(":checked")?jQuery.each(jQuery("input[name='fileId']"),function(a,b){a=jQuery(this).attr("id");jQuery("#"+a+"_s1").attr("class","checked");jQuery("#"+a+"_s2").attr("class","checked");jQuery(this).attr("checked",!0)}):jQuery.each(jQuery("input[name='fileId']"),function(a,b){a=jQuery(this).attr("id");jQuery("#"+a+"_s1").attr("class","");jQuery("#"+a+"_s2").attr("class","");jQuery(this).removeAttr("checked")})}
function submitSignUpForm(){var a=jQuery("#username").val(),b=jQuery("#password").val(),c=jQuery("#nickname").val(),d=jQuery("#company").val(),e=jQuery("#smscode").val();if(null==a||""==a)return jAlert("\u8bf7\u8f93\u5165\u60a8\u7684\u624b\u673a\u53f7\u7801","\u53cb\u60c5\u63d0\u793a"),!1;if(null==b||""==b)return jAlert("\u8bf7\u8f93\u5165\u60a8\u7684\u767b\u5f55\u5bc6\u7801(6-15\u4f4d)","\u53cb\u60c5\u63d0\u793a"),!1;if(null==c||""==c)return jAlert("\u8bf7\u8f93\u5165\u60a8\u7684\u6635\u79f0","\u53cb\u60c5\u63d0\u793a"),
    !1;if(null==e||""==e)return jAlert("\u8bf7\u8f93\u5165\u60a8\u7684\u77ed\u4fe1\u9a8c\u8bc1\u7801","\u53cb\u60c5\u63d0\u793a"),!1;jQuery.post("/user/signup","username="+a+"&password="+b+"&nickname="+c+"&company="+d+"&smscode="+e,function(a){"000000"==a.code?jConfirm("\u6ce8\u518c\u5df2\u6210\u529f,\u662f\u5426\u524d\u5f80\u767b\u5f55?","\u53cb\u60c5\u63d0\u793a",function(a){location.href=1==a?"/static/login.html":"/static/signup.html"}):jAlert(a.msg,"\u53cb\u60c5\u63d0\u793a")})}var btnlock=!1;
function uploadfile(){if(1==btnlock)return alert("\u6b63\u5728\u5904\u7406,\u8bf7\u8010\u5fc3\u7b49\u5f85..."),!1;var a=jQuery("#file_status"),b=jQuery("#file_deal"),c=jQuery("#file_down"),d=jQuery("#file_path");a.show();b.show();btnlock=!0;var e=jQuery("input[name='uploadtype']:checked").val();jQuery("#uploadfile").ajaxSubmit({type:"post",url:"/codegen/uploadFile?uploadtype="+e,success:function(f){"000000"==f.code?(f=encodeURI(f.data.path),d.attr("href","/codegen/downUploadFile?filePath="+f),b.hide(),
        c.show()):(a.hide(),b.hide(),c.hide(),void 0==f.msg?alert("\u60a8\u5c1a\u672a\u767b\u5f55\u6216\u767b\u5f55\u5df2\u8d85\u65f6"):alert(f.msg));btnlock=!1},error:function(d,e,h){alert("\u4e0a\u4f20\u6216\u5904\u7406\u5931\u8d25,\u8bf7\u5c1d\u8bd5\u5237\u65b0\u9875\u9762\u518d\u64cd\u4f5c");a.hide();b.hide();c.hide();btnlock=!1}})};